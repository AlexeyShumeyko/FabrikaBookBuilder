<Window x:Class="PhotoBookRenamer.Utils.MultiFolderBrowserDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:utils="clr-namespace:PhotoBookRenamer.Utils"
        Title="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð°Ð¿ÐºÐ¸ Ñ Ñ„Ð¾Ñ‚Ð¾Ð³Ñ€Ð°Ñ„Ð¸ÑÐ¼Ð¸" 
        Height="650" Width="800"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="#eceff5">
    <Window.Resources>
        <utils:ErrorToBackgroundConverter x:Key="ErrorToBackgroundConverter"/>
        <utils:ErrorToForegroundConverter x:Key="ErrorToForegroundConverter"/>
        <utils:ErrorToFontWeightConverter x:Key="ErrorToFontWeightConverter"/>
    </Window.Resources>
    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <TextBlock Grid.Row="0" 
                   Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð°Ð¿ÐºÐ¸ Ñ JPG/JPEG Ñ„Ð°Ð¹Ð»Ð°Ð¼Ð¸. Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ctrl+Ð›ÐšÐœ Ð¸Ð»Ð¸ Shift+Ð›ÐšÐœ Ð´Ð»Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð° Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ð¿Ð°Ð¿Ð¾Ðº." 
                   TextWrapping="Wrap" 
                   Margin="0,0,0,15" 
                   FontSize="14" 
                   Foreground="#4A4A4A"/>
        
        <!-- Error Message -->
        <Border Grid.Row="1" 
                Background="#FFE5E5" 
                Padding="12" 
                Margin="0,0,0,15"
                CornerRadius="6"
                x:Name="ErrorBorder"
                Visibility="Collapsed">
            <StackPanel>
                <TextBlock Text="âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð²Ð°Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸" 
                           Foreground="#D32F2F" FontSize="13" FontWeight="Bold"
                           Margin="0,0,0,5"/>
                <TextBlock x:Name="ErrorTextBlock" 
                           Foreground="#D32F2F" FontSize="12" 
                           TextWrapping="Wrap"/>
            </StackPanel>
        </Border>
        
        <Grid Grid.Row="2" Margin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Navigation Tree -->
            <ListBox Grid.Column="0" 
                     x:Name="NavigationTree"
                     BorderBrush="#E0E0E0"
                     BorderThickness="1"
                     Background="White"
                     Margin="0,0,10,0"
                     SelectionChanged="NavigationTree_SelectionChanged">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ðŸ“" Margin="0,0,5,0"/>
                            <TextBlock Text="{Binding Name}"/>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
            
            <!-- Navigation buttons and folder list -->
            <Grid Grid.Column="1">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Navigation buttons for folder browsing -->
                <StackPanel Grid.Row="0"
                            Orientation="Horizontal" 
                            Margin="0,0,0,5"
                            HorizontalAlignment="Left">
                    <Button Content="â† ÐÐ°Ð·Ð°Ð´" 
                            Click="BackButton_Click" 
                            Padding="10,5"
                            Margin="0,0,5,0"
                            x:Name="BackButton"
                            IsEnabled="False"
                            ToolTip="Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð² Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÑƒÑŽ Ð¿Ð°Ð¿ÐºÑƒ"/>
                    <TextBlock x:Name="CurrentPathTextBlock" 
                               VerticalAlignment="Center"
                               Margin="5,0"
                               Foreground="#666"
                               FontSize="12"
                               TextTrimming="CharacterEllipsis"
                               MaxWidth="400"/>
                </StackPanel>
                
                <!-- Folder List -->
                <ListBox Grid.Row="1"
                         x:Name="FoldersListBox"
                         BorderBrush="#E0E0E0"
                         BorderThickness="1"
                         Background="White"
                         SelectionMode="Extended"
                         MouseDoubleClick="FoldersListBox_MouseDoubleClick"
                         SelectionChanged="FoldersListBox_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“" Margin="0,0,8,0" FontSize="16"/>
                                <StackPanel>
                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding FullPath}" 
                                               FontSize="11" 
                                               Foreground="#999"
                                               TextTrimming="CharacterEllipsis"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Grid>
        </Grid>
        
        <!-- Selected Folders -->
        <Border Grid.Row="3" 
                Background="White" 
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="6"
                Padding="10"
                Margin="0,0,0,15">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0"
                           Text="Ð’Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð°Ð¿ÐºÐ¸:" 
                           FontWeight="SemiBold" 
                           Margin="0,0,0,8"/>
                <ListBox Grid.Row="1"
                         x:Name="SelectedFoldersListBox"
                         MaxHeight="100"
                         BorderThickness="0"
                         SelectionMode="Extended"
                         SelectionChanged="SelectedFoldersListBox_SelectionChanged">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border Background="{Binding HasError, Converter={StaticResource ErrorToBackgroundConverter}}"
                                    Padding="5,2"
                                    CornerRadius="3"
                                    Margin="0,1">
                                <TextBlock Text="{Binding Path}" 
                                           TextTrimming="CharacterEllipsis"
                                           Foreground="{Binding HasError, Converter={StaticResource ErrorToForegroundConverter}}"
                                           FontWeight="{Binding HasError, Converter={StaticResource ErrorToFontWeightConverter}}"/>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
                <Button Grid.Row="2"
                        Content="Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ"
                        Click="RemoveSelectedButton_Click"
                        HorizontalAlignment="Right"
                        Margin="0,8,0,0"
                        Padding="10,5"
                        x:Name="RemoveSelectedButton"
                        IsEnabled="False">
                </Button>
            </Grid>
        </Border>
        
        <!-- Buttons -->
        <StackPanel Grid.Row="4" Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            <Button Content="Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ" 
                    Click="AddSelectedButton_Click" 
                    Padding="20,10" 
                    Margin="0,0,10,0"
                    MinWidth="150"
                    x:Name="AddSelectedButton"/>
            <Button Content="Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ" 
                    Click="OkButton_Click" 
                    Padding="25,10" 
                    Margin="0,0,10,0"
                    IsDefault="True"
                    MinWidth="100"
                    x:Name="OkButton"/>
            <Button Content="ÐžÑ‚Ð¼ÐµÐ½Ð°" 
                    Click="CancelButton_Click" 
                    Padding="25,10"
                    IsCancel="True"
                    MinWidth="100"/>
        </StackPanel>
    </Grid>
</Window>

